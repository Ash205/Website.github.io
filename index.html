<html>
    <head>
        <title>Firebase</title>
        <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <script src="chartjs.js"></script>
    </head>
    <body>
        <script>
            $(document).ready(function(){
                var a = new Array(6);
                    for(let j=0;j<6;j++){
                        a[j]=new Array();
                    }
                var config = {
                    apiKey: "AIzaSyDBFbVqUGu8cr9MFz1avn1QqNAhgkR2eb4",
                    authDomain: "blitzkrieg-4d19f.firebaseio.com",
                    databaseURL: "https://blitzkrieg-4d19f.firebaseio.com",
                    storageBucket: "blitzkrieg-4d19f.appspot.com",
                    messagingSenderId: "660102165040"
                };
                firebase.initializeApp(config);
                var database = firebase.database();
                // console.log(database);
                var sensors = database.ref('Data');
                // console.log(sensors);
                // var data = {
                //     name:"mouli",
                //     age:"19"
                // }
                // sensors.push(data);
                // console.log(database)
                sensors.on("value", gotData, errData);

                function gotData(data){
                    var maindata = data.val();
                    var keys = Object.keys(maindata);
                    display(maindata, keys);
                    //console.log('hello');
                }
                function display(maindata, keys){
                    for(let i=0; i<keys.length; i++){
                        var temp = Object.keys(maindata[keys[i]]);
                        //console.log(keys[i] + maindata[keys[i]][temp[temp.length-1]]);
                        a[i].push(maindata[keys[i]][temp[temp.length-1]]);
                        if(a[5].length>5){
                            chart1(a[0].slice(a[i].length - 6));
                             chart2(a[1].slice(a[i].length - 6));
                            chart3(a[2].slice(a[i].length - 6));
                            chart4(a[3].slice(a[i].length - 6));
                            chart5(a[4].slice(a[i].length - 6));
                            chart6(a[5].slice(a[i].length - 6));
                        }
                    }
                    // for(let i=0; i<keys.length; i++){
                    //     //var temp = Object.keys(maindata[keys[i]]);
                    //     console.log(maindata[keys[i]]);
                    //     a[i].push(maindata[keys[i]]);
                    //     for(let k=0;k<a.length;k++){
                    //         if(a[i].length>6){
                    //             a = a[i].slice(a[i].length - 6)
                    //         }
                    //     }
                    //     chart1(a[0]);
                    //     chart2(a[1]);
                    //     chart3(a[2]);
                    //     chart4(a[3]);
                    //     chart5(a[4]);
                    //     chart6(a[5]);
                    // }
                }
                function errData(){
                    console.log('error');
                }
            });
        </script>

        <div class="container">
            <div class="row">
                <div class="col-4"><canvas width="200" height="200" id="c1"></canvas></div>
                <div class="col-4"><canvas width="200" height="200" id="c2"></canvas></div>
                <div class="col-4"><canvas width="200" height="200" id="c3"></canvas></div>
            </div>
            <div class="row">
                <div class="col-4"><canvas width="200" height="200" id="c4"></canvas></div>
                <div class="col-4"><canvas width="200" height="200" id="c5"></canvas></div>
                <div class="col-4"><canvas width="200" height="200" id="c6"></canvas></div>
            </div>
        </div>
    </body>
</html>
